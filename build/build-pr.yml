stages:
- stage: BuildLibrary
  jobs:
  - job: BuildLibrary
    pool:
        name: Hosted macOS
        vmImage: 'macOS-latest'
        demands:
        - MSBuild
        - Xamarin.Android
        - xcode
        - Xamarin.iOS
        - msbuild

    steps:

    - task: NuGetToolInstaller@1
      displayName: Use Nuget $(NugetVersion)
      inputs:
        versionSpec: $(NugetVersion)

    - task: NuGetCommand@2
      displayName: 'NuGet restore MobCAT.sln'
      inputs:
        command: 'restore'
        restoreSolution: 'MobCAT.sln'

    - task: MSBuild@1
      displayName: 'Build MobCAT'
      inputs:
        solution: 'MobCAT/MobCAT.csproj'
        configuration: '$(BuildConfiguration)'

    - task: MSBuild@1
      displayName: 'Build MobCAT.Forms'
      inputs:
        solution: 'MobCAT.Forms/MobCAT.Forms.csproj'
        configuration: '$(BuildConfiguration)'

    - task: MSBuild@1
      displayName: 'Build MobCAT.Android'
      inputs:
        solution: 'MobCAT.Android/MobCAT.Android.csproj'
        configuration: '$(BuildConfiguration)'

    - task: MSBuild@1
      displayName: 'Build MobCAT.iOS'
      inputs:
        solution: 'MobCAT.iOS/MobCAT.iOS.csproj'
        configuration: '$(BuildConfiguration)'